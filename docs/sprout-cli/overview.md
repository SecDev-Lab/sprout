# sprout CLIツール概要

## 目的

`sprout`は、`git worktree`と`docker compose`を併用する開発ワークフローにおいて、ブランチごとの独立した開発環境のセットアップを自動化・簡略化するCLIツールです。

## 主な機能

### 1. 開発環境の自動セットアップ
- git worktreeの作成
- `.env.example`をテンプレートとした`.env`ファイルの自動生成
- ポート番号の自動割り当て（衝突回避）
- 環境変数の対話的設定

### 2. 統一的な管理
- すべてのworktreeを`.sprout/`ディレクトリに集約
- 一覧表示、削除、パス取得などの管理機能
- 現在のworktreeの視覚的表示

## 設計思想

### シンプルさの追求
- 必要最小限の機能に絞り込み
- 直感的なコマンド体系
- 設定ファイル不要

### 安全性の確保
- 削除操作時の確認プロンプト
- エラー時の適切なロールバック
- ポート衝突の自動回避

### 開発効率の向上
- 単一コマンドでの環境構築
- 環境変数の再利用（シェル環境変数から自動取得）
- Docker Compose変数構文との互換性維持

## アーキテクチャ

### ディレクトリ構造
```
/your-project
├── .git/
├── .sprout/              # sprout管理ディレクトリ
│   └── <branch-name>/    # 各worktree
│       ├── .env          # 自動生成された環境設定
│       └── ...           # ソースコード
├── .env.example          # テンプレート
└── compose.yaml          # Docker Compose設定
```

### テンプレート構文
- `{{ VARIABLE }}`: ユーザー入力または環境変数
- `{{ auto_port() }}`: 自動ポート割り当て
- `${...}`: Docker Compose変数（そのまま保持）

## 実装詳細

### 使用技術
- **言語**: Python 3.11+
- **CLIフレームワーク**: Typer
- **UI**: Rich（カラフルな出力）
- **パッケージ管理**: Hatch, uv

### エラーハンドリング
- Gitリポジトリチェック
- ファイル存在確認
- ポート利用可能性検証
- ユーザーキャンセル対応

### テスト戦略
- 単体テスト（pytest）
- 統合テスト
- モックを活用した外部コマンドテスト
- カバレッジ目標: 80%以上